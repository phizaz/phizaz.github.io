<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>SSH using docker | Konpat’s Record of Struggles</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="SSH using docker" />
<meta name="author" content="Konpat Preechakul" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Let’s say you want to ssh using docker, and also you want to be able to access all the settings you have with our old ssh, here is how you do it ! Dockerfile: FROM debian:jessie RUN apt-get update RUN apt-get install -y --no-install-recommends openssh-client VOLUME [&quot;/ssh&quot;] COPY entrypoint.sh /usr/local/bin/ ENTRYPOINT [&quot;entrypoint.sh&quot;] entrypoint.sh: #!/usr/bin/env bash # install ssh keys (/ssh -&gt; ~/.ssh) cp -R /ssh /root/.ssh chmod -R 500 /root/.ssh # entrypoint # redirects all arguments to the ssh command # &#39;exec&#39; will replace the process (might be useful for redirecting SIGTERM) exec ssh $@ If we mount our .ssh directory to the /ssh of the container, it will automatically copy (with the right permission) its contents to its /root/.ssh. Thus, we will be able to use all ssh as if it were the one on our host machine. Build the Dockerfile: docker build -t ssh . Set alias for your cmd.exe: alias ssh-docker=docker run --rm -it -v %HOME%\.ssh:/ssh:ro ssh $* Note: $* at the end of alias is to accept arguments. Enjoy: ssh-docker test@host" />
<meta property="og:description" content="Let’s say you want to ssh using docker, and also you want to be able to access all the settings you have with our old ssh, here is how you do it ! Dockerfile: FROM debian:jessie RUN apt-get update RUN apt-get install -y --no-install-recommends openssh-client VOLUME [&quot;/ssh&quot;] COPY entrypoint.sh /usr/local/bin/ ENTRYPOINT [&quot;entrypoint.sh&quot;] entrypoint.sh: #!/usr/bin/env bash # install ssh keys (/ssh -&gt; ~/.ssh) cp -R /ssh /root/.ssh chmod -R 500 /root/.ssh # entrypoint # redirects all arguments to the ssh command # &#39;exec&#39; will replace the process (might be useful for redirecting SIGTERM) exec ssh $@ If we mount our .ssh directory to the /ssh of the container, it will automatically copy (with the right permission) its contents to its /root/.ssh. Thus, we will be able to use all ssh as if it were the one on our host machine. Build the Dockerfile: docker build -t ssh . Set alias for your cmd.exe: alias ssh-docker=docker run --rm -it -v %HOME%\.ssh:/ssh:ro ssh $* Note: $* at the end of alias is to accept arguments. Enjoy: ssh-docker test@host" />
<link rel="canonical" href="/dev/2017/02/04/ssh-using-docker.html" />
<meta property="og:url" content="/dev/2017/02/04/ssh-using-docker.html" />
<meta property="og:site_name" content="Konpat’s Record of Struggles" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-02-04T09:39:12+07:00" />
<script type="application/ld+json">
{"description":"Let’s say you want to ssh using docker, and also you want to be able to access all the settings you have with our old ssh, here is how you do it ! Dockerfile: FROM debian:jessie RUN apt-get update RUN apt-get install -y --no-install-recommends openssh-client VOLUME [&quot;/ssh&quot;] COPY entrypoint.sh /usr/local/bin/ ENTRYPOINT [&quot;entrypoint.sh&quot;] entrypoint.sh: #!/usr/bin/env bash # install ssh keys (/ssh -&gt; ~/.ssh) cp -R /ssh /root/.ssh chmod -R 500 /root/.ssh # entrypoint # redirects all arguments to the ssh command # &#39;exec&#39; will replace the process (might be useful for redirecting SIGTERM) exec ssh $@ If we mount our .ssh directory to the /ssh of the container, it will automatically copy (with the right permission) its contents to its /root/.ssh. Thus, we will be able to use all ssh as if it were the one on our host machine. Build the Dockerfile: docker build -t ssh . Set alias for your cmd.exe: alias ssh-docker=docker run --rm -it -v %HOME%\\.ssh:/ssh:ro ssh $* Note: $* at the end of alias is to accept arguments. Enjoy: ssh-docker test@host","author":{"@type":"Person","name":"Konpat Preechakul"},"@type":"BlogPosting","url":"/dev/2017/02/04/ssh-using-docker.html","headline":"SSH using docker","dateModified":"2017-02-04T09:39:12+07:00","datePublished":"2017-02-04T09:39:12+07:00","mainEntityOfPage":{"@type":"WebPage","@id":"/dev/2017/02/04/ssh-using-docker.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Konpat's Record of Struggles" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Konpat&#39;s Record of Struggles</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>
        
        <div class="trigger">
          <!--
            my_page.autogen is populated by the pagination logic for all pages
                            that are automatically created by the gem. Check for non-existence to exclude pagination pages from site.pages iterators
          -->
          
            
          
            
            <a class="page-link" href="/about/">About</a>
            
          
            
          
            
            <a class="page-link" href="/tags/">Tags</a>
            
          
            
          
            
          
            
            <a class="page-link" href="/all/index.html">All Posts</a>
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
            <a class="page-link" href="/dev/index.html">Development</a>
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">SSH using docker</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2017-02-04T09:39:12+07:00" itemprop="datePublished">Feb 4, 2017
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Let’s say you want to <code class="highlighter-rouge">ssh</code> using docker, and also you want to be able to access all the settings you have with our old ssh, here is how you do it !</p>

<p>Dockerfile:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FROM debian:jessie

RUN apt-get update
RUN apt-get install -y --no-install-recommends openssh-client

VOLUME ["/ssh"]

COPY entrypoint.sh /usr/local/bin/
ENTRYPOINT ["entrypoint.sh"]
</code></pre></div></div>

<p>entrypoint.sh:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>

<span class="c"># install ssh keys (/ssh -&gt; ~/.ssh)</span>
<span class="nb">cp</span> <span class="nt">-R</span> /ssh /root/.ssh
<span class="nb">chmod</span> <span class="nt">-R</span> 500 /root/.ssh

<span class="c"># entrypoint</span>
<span class="c"># redirects all arguments to the ssh command</span>
<span class="c"># 'exec' will replace the process (might be useful for redirecting SIGTERM)</span>
<span class="nb">exec </span>ssh <span class="nv">$@</span> 
</code></pre></div></div>

<p>If we mount our <code class="highlighter-rouge">.ssh</code> directory to the <code class="highlighter-rouge">/ssh</code> of the container, it will automatically copy (with the right permission) its contents to its <code class="highlighter-rouge">/root/.ssh</code>. Thus, we will be able to use all ssh as if it were the one on our host machine.</p>

<p>Build the Dockerfile:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker build -t ssh .
</code></pre></div></div>

<p>Set alias for your <code class="highlighter-rouge">cmd.exe</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alias ssh-docker=docker run --rm -it -v %HOME%\.ssh:/ssh:ro ssh $*
</code></pre></div></div>

<p>Note: <code class="highlighter-rouge">$*</code> at the end of alias is to accept arguments.</p>

<p>Enjoy:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh-docker test@host
</code></pre></div></div>


    <small>
      
      <a href="/tags/docker/">docker</a>
      
    </small>
  </div><a class="u-url" href="/dev/2017/02/04/ssh-using-docker.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">Konpat&#39;s Record of Struggles</h2>
        <ul class="contact-list">
          <li class="p-name">Konpat Preechakul</li><li><a class="u-email" href="mailto:the.akita.ta@gmail.com">the.akita.ta@gmail.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>O thou, I long to rival thy greatest invention, the mind.</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://www.facebook.com/phizaz" title="phizaz"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg></a></li><li><a href="https://github.com/phizaz" title="phizaz"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.instagram.com/phizaz" title="phizaz"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#instagram"></use></svg></a></li><li><a href="https://twitter.com/phizaz" title="phizaz"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="rss"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
